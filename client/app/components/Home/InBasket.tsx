'use client'
import { RootState } from '@/app/store'
import { addToBasket } from '@/app/store/reducers/cartReducer'
import React, { useEffect, useState } from 'react'
import { useDispatch, useSelector } from 'react-redux'

type Props = {
  selectGoods: any
  selectVolumeIdx: number
}

const InBasket = ({ selectGoods, selectVolumeIdx }: Props) => {
  const [isInBasket, setIsInBasket] = useState(false) //тимчасово
  const dispatch = useDispatch()

  const { basket } = useSelector((state: RootState) => state.BasketAndLike)

  useEffect(() => {
    setIsInBasket(basket.findIndex(x => x.id == selectGoods.id) != -1)
  }, [basket])

  const inBasket = (e: any) => {
    e.preventDefault()
    if (!isInBasket) {
      dispatch(
        addToBasket({
          id: selectGoods.id,
          nameUA: selectGoods.name,
          nameRU: selectGoods.name,
          volume: selectGoods.listVolume[selectVolumeIdx],
          count: 1
        })
      )
    }
  }
  return (
    <div onClick={inBasket} className={isInBasket ? 'in-basket' : 'basket'}>
      {!isInBasket ? (
        <svg
          width='52'
          height='38'
          viewBox='0 0 52 38'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
        >
          <path
            d='M35.0992 12.3954C34.9405 12.9233 34.7766 13.4494 34.6248 13.9791C33.9216 16.4322 33.2223 18.8867 32.5209 21.3404C32.3894 21.7998 32.1913 21.9466 31.7113 21.9466C27.9061 21.9466 24.1009 21.9466 20.2957 21.9466C19.7771 21.9466 19.477 22.1844 19.4766 22.5945C19.4761 23.0028 19.7789 23.2427 20.2952 23.2427C24.0931 23.2427 27.8909 23.2427 31.6892 23.2427C32.2073 23.2427 32.5083 23.4813 32.5083 23.891C32.5083 24.3002 32.2069 24.5393 31.6897 24.5393C31.4172 24.5393 31.1448 24.5393 30.8165 24.5393C32.0296 24.8584 32.6268 25.7028 32.4733 26.8179C32.3505 27.7104 31.489 28.4349 30.5597 28.4276C29.5512 28.4198 28.7429 27.6771 28.6408 26.63C28.5569 25.7691 29.094 24.8038 30.3067 24.5488H21.7267C22.2547 24.667 22.6945 24.9264 23.005 25.3746C23.3138 25.8206 23.4098 26.3173 23.3203 26.8543C23.1719 27.7433 22.2841 28.4635 21.3725 28.4263C20.338 28.3838 19.5605 27.6221 19.4805 26.5728C19.4087 25.6318 20.1045 24.7722 21.107 24.5393C20.7973 24.5393 20.4877 24.5423 20.178 24.5388C19.2621 24.5276 18.5299 23.9975 18.2722 23.163C17.9993 22.2796 18.3807 21.3395 19.1929 20.8935C19.2422 20.8662 19.2906 20.8367 19.349 20.803C18.5706 17.2949 17.7934 13.7933 17.0129 10.277C16.6526 10.277 16.3015 10.277 15.9499 10.277C15.1948 10.277 14.4393 10.2813 13.6842 10.2752C13.1895 10.2713 12.8716 9.82487 13.0502 9.39053C13.1558 9.1346 13.3573 8.9865 13.6341 8.9852C14.9288 8.97913 16.2236 8.9774 17.5184 8.9852C17.8791 8.98736 18.0962 9.19522 18.1827 9.57587C18.3323 10.2345 18.4776 10.8941 18.6294 11.5744H18.9083C24.0152 11.5744 29.1226 11.5774 34.2295 11.5687C34.63 11.5679 34.9271 11.6757 35.0996 12.0498V12.3954H35.0992ZM18.917 12.88C19.4934 15.4774 20.0673 18.0627 20.6399 20.6423H31.3757C32.1139 18.0553 32.8508 15.4731 33.5908 12.88H18.917ZM22.0627 26.5027C22.0726 26.151 21.7863 25.8483 21.4348 25.8384C21.0836 25.8284 20.7813 26.1151 20.7714 26.4672C20.7614 26.8188 21.0477 27.1215 21.3993 27.1315C21.7505 27.1414 22.0527 26.8547 22.0627 26.5027ZM31.2131 26.4797C31.2101 26.1268 30.9138 25.8354 30.5618 25.8384C30.2098 25.8414 29.9183 26.1381 29.9213 26.4905C29.9244 26.843 30.2206 27.1349 30.5726 27.1319C30.9246 27.1289 31.2161 26.8322 31.2131 26.4797Z'
            fill='white'
            stroke='white'
            strokeWidth='0.441992'
          />
        </svg>
      ) : (
        <svg
          width='52'
          height='37'
          viewBox='0 0 52 37'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
        >
          <rect
            x='1'
            y='-1'
            width='50'
            height='34'
            rx='4'
            transform='matrix(1 0 0 -1 0 34.2261)'
            stroke='#FE680A'
            strokeWidth='2'
          />
          <path
            d='M26.3243 30.0797H24.7897C24.7169 30.0647 24.6445 30.0467 24.5708 30.0363C24.1033 29.9702 23.6285 29.9368 23.1686 29.8359C20.4085 29.2314 18.1341 27.8274 16.4113 25.5864C14.4385 23.0199 13.6901 20.102 14.1152 16.8997C14.3905 14.8247 15.1823 12.9436 16.5198 11.3284C19.2912 7.98235 22.8657 6.5693 27.1695 7.08252C29.2553 7.33121 31.1251 8.16593 32.7629 9.48899C35.0142 11.3076 36.4096 13.6422 36.9296 16.4923C37.0061 16.9105 37.0513 17.3347 37.1105 17.7561V19.2908C37.0761 19.572 37.0477 19.8537 37.0061 20.1341C36.6977 22.2299 35.9028 24.1191 34.5643 25.7641C32.7493 27.9951 30.4242 29.3815 27.5904 29.8979C27.1713 29.9743 26.7462 30.0195 26.3234 30.0792L26.3243 30.0797ZM35.3054 18.5239C35.3054 13.162 30.9401 8.79038 25.5683 8.77365C20.2114 8.75692 15.8086 13.1552 15.8086 18.5234C15.8086 23.8853 20.1739 28.257 25.5457 28.2737C30.9026 28.2904 35.3054 23.8921 35.3054 18.5239Z'
            fill='#FE680A'
          />
          <path
            d='M23.9716 20.2588C24.0444 20.1892 24.1095 20.129 24.1723 20.0666C25.8789 18.3601 27.5867 16.6554 29.2896 14.9458C29.5709 14.6636 29.8847 14.5139 30.2817 14.6324C30.8903 14.8142 31.1259 15.516 30.7533 16.0287C30.6918 16.1133 30.6167 16.1888 30.5426 16.263C28.6086 18.1987 26.6738 20.1336 24.7389 22.0684C24.2094 22.5979 23.7342 22.5975 23.2029 22.0662C22.3044 21.1681 21.4077 20.2683 20.5075 19.3717C20.2362 19.1017 20.1114 18.7924 20.2249 18.4135C20.408 17.8035 21.108 17.5661 21.6203 17.9405C21.7048 18.002 21.7808 18.0762 21.8554 18.1503C22.4993 18.7929 23.1418 19.4368 23.7848 20.0798C23.8423 20.1372 23.9019 20.1919 23.9716 20.2584V20.2588Z'
            fill='#FE680A'
          />
        </svg>
      )}
      <p>Купить</p>
    </div>
  )
}

export default InBasket
